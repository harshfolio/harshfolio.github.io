<script>
    // Add language labels to code blocks
    document.addEventListener('DOMContentLoaded', function() {
        document.querySelectorAll('.highlight').forEach(block => {
            const code = block.querySelector('code[data-lang]');
            if (code) {
                const lang = code.getAttribute('data-lang');
                if (lang) {
                    block.setAttribute('data-lang', lang);
                }
            }
        });
    });
</script>

<script>
    // Reading progress indicator with show/hide on scroll
    document.addEventListener('DOMContentLoaded', function() {
        const progress = document.querySelector('.reading-progress');
        const progressBar = document.querySelector('.reading-progress-bar');
        const postContent = document.querySelector('.post-content');

        if (progress && progressBar && postContent) {
            let scrollTimeout;
            let isScrolling = false;

            const updateProgress = () => {
                const windowHeight = window.innerHeight;
                const documentHeight = postContent.scrollHeight;
                const scrollTop = window.scrollY;
                const trackLength = documentHeight - windowHeight;
                const scrollPercent = (scrollTop / trackLength) * 100;

                progressBar.style.width = `${Math.min(Math.max(scrollPercent, 0), 100)}%`;

                // Show on scroll
                if (!isScrolling) {
                    progress.classList.add('visible');
                    isScrolling = true;
                }

                // Hide after 1 second of no scrolling
                clearTimeout(scrollTimeout);
                scrollTimeout = setTimeout(() => {
                    progress.classList.remove('visible');
                    isScrolling = false;
                }, 1000);
            };

            window.addEventListener('scroll', updateProgress, { passive: true });
            updateProgress();
        }
    });
</script>
